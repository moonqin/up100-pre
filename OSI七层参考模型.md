#OSI七层参考模型

开放系统互连参考模型 (Open System Interconnect 简称OSI）是国际标准化组织(ISO)和国际电报电话咨询委员会(CCITT)联合制定的开放系统互连参考模型，为开放式互连信息系统提供了一种功能结构的框架。它从低到高分别是：物理层、数据链路层、网络层、传输层、会话层、表示层和应用层。

##概述
OSI参考模型是计算机网路体系结构发展的产物。它的基本内容是开放系统通信功能的分层结构。这个模型把开放系统的通信功能划分为七个层次，从邻接物理媒体的层次开始，分别赋于1，2，……7层的顺序编号，相应地称之为物理层、数据链路层、网络层、运输层、会话层、表示层和应用层。每一层的功能是独立的。它利用其下一层提供的服务并为其上一层提供服务，而与其他层的具体实现无关。这里所谓的“服务”就是下一层向上一层提供的通信功能和层之间的会话规定，一般用通信原语实现。两个开放系统中的同等层之间的通信规则和约定称之为协议。通常把1～4层协议称为下层协议，5～7层协议称为上层协议。
1、国际标准化组织ISO在1979年建立了一个分委员会来专门研究一种用于开放系统的体系结构，提出了开放系统互连OSI模型，这是一个定义连接异种计算机的标准主体结构。
　　2、OSI简介：OSI采用了分层的结构化技术，共分七层，物理层、数据链路层、网络层、传输层、会话层、表示层、应用层。
　　3、OSI参考模型的特性：是一种异构系统互连的分层结构；提供了控制互连系统交互规则的标准骨架；定义一种抽象结构，而并非具体实现的描述；不同系统中相同层的实体为同等层实体；同等层实体之间通信由该层的协议管理；相信层间的接口定义了原语操作和低层向上层提供的服务；所提供的公共服务是面向连接的或无连接的数据服务；直接的数据传送仅在最低层实现；每层完成所定义的功能，修改本层的功能并不影响其他层。
　　4、物理层：提供为建立、维护和拆除物理链路所需要的机械的、电气的、功能的和规程的特性；有关的物理链路上传输非结构的位流以及故障检测指示。
　　5、数据链路层：在网络层实体间提供数据发送和接收的功能和过程；提供数据链路的流控。
　　6、网络层：控制分组传送系统的操作、路由选择、拥护控制、网络互连等功能，它的作用是将具体的物理传送对高层透明。
　　7、传输层：提供建立、维护和拆除传送连接的功能；选择网络层提供最合适的服务；在系统之间提供可靠的透明的数据传送，提供端到端的错误恢复和流量控制。
　　8、会话层：提供两进程之间建立、维护和结束会话连接的功能；提供交互会话的管理功能，如三种数据流方向的控制，即一路交互、两路交替和两路同时会话模式 。
　　9、表示层：代表应用进程协商数据表示；完成数据转换、格式化和文本压缩。
　　10、应用层：提供OSI用户服务，例如事务处理程序、文件传送协议和网络管理等。
　　
###物理层

物理层是OSI的第一层，它虽然处于最底层，却是整个开放系统的基础。物理层为设备之间的数据通信提供传输媒体及互连设备，为数据传输提供可靠的环境。物理层的媒体包括同轴电缆、双绞线、光纤、无线信道等。通信用的互连设备指DTE（Data Terminal Equipment）和DCE（Data Communications Equipment）间的互连设备。DTE即数据终端设备，又称物理设备，如计算机、终端等都包括在内。而DCE则是数据通信设备或电路连接设备，如调制解调器等。数据传输通常是经过DTE-DCE，再经过DCE-DTE的路径。互连设备指将DTE、DCE连接起来的装置，如各种插头、插座。LAN中的各种粗、细同轴电缆、T型接头、插头、接收器、发送器、中继器等都属物理层的媒体和连接器。

其中双绞线（Twisted Pair）是[综合布线](http://baike.baidu.com/view/16242.htm)工程中最常用的一种[传输介质](http://baike.baidu.com/view/305337.htm)。

双绞线内部为8根4对线，线的排序分为两种568A和568B

568A：白绿 绿 白橙 蓝 白蓝 橙 白棕 棕

568B：白橙 橙 白绿 蓝 白蓝 绿 白棕 棕

光纤大致分为两类，单模光纤和多模光纤。注：下表只为最大传输

| 类型   |   传输距离   | 传输速度   | 成本   |
| :--- | :------: | ------ | ---- |
| 单模   | 10-20 公里 | 40Gb/s | 高    |
| 多模   |   2 公里   | 10Gb/s | 低    |
物理层的主要功能是：①为数据端设备提供传送数据的通路，数据通路可以是一个物理媒体，也可以是多个物理媒体连接而成。一次完整的数据传输，包括激活物理连接、传送数据和终止物理连接。所谓激活，就是不管有多少物理媒体参与，都要在通信的两个数据终端设备间连接起来，形成一条通路。②传输数据。物理层要形成适合数据传输需要的实体，为数据传送服务。一是要保证数据能在其上正确通过，二是要提供足够的带宽(带宽是指每秒钟内能通过的比特(Bit)数)，以减少信道上的拥塞。传输数据的方式能满足点到点，一点到多点，串行或并行，半双工或全双工，同步或异步传输的需要。③完成物理层的一些管理工作。

###数据链路层
数据链路层主要将数据组合成数据块，在数据链路层中该数据块称之为帧（frame），帧也是数据链路层主要传输的单位。
帧的组成
源MAC地址  目标MAC地址  数据本身 校验码
MAC地址即物理地址，以太网网卡的物理地址，它一定是全球唯一的。
MAC地址是48bit（比特位）的整数，如：44-45-53-54-00-00,前三位为厂商号，后三位为流水号
形象地说，MAC地址就如同我们身份证上的身份证号码，具有全球唯一性。
获取方法
在Windows 中
单击开始，点击运行，输入cmd，进入后输入ipconfig /all 即可。
在linux/unix中
在命令行输入ipconfig即可看到MAC地址
二层的设备为交换机，工作模式为广播，学习，转发
首先在两台机器在没有通信过的情况下，先通过交换机广播，找到目标机器MAC地址后交换机会自动在自己的MAC地址表中记录双方的MAC地址对应关系（学习），当两台机器再次通信时，交换机会现从MAC地址表中找有没有相应的对应关系如果有那么就进行转发，会省略广播的步骤

###网络层
网络层会涉及到一个IP地址，IP地址目前有IPV4,IPV6两个版本
IPV4是由32位组成   分为5类
32位，以点“.”分隔，8位为一组，十进制表示——叫做点分十进制
5类的范围
A 0.0.0.0-127.255.255.255
B 128.0.0.0-191.255.255.255
C 192.0.0.0-223.255.255.255
D 224.0.0.0-239.255.255.255
E 240.0.0.0-247.255.255.255
A,B,C三类可分配给主机使用，根据需求来使用某类IP
D类		特殊使用，组播地址
E类		留待后用,科研

根据IP地址用途分类:
公用地址  公网上用
私有地址  局域网用
A类私有 		 10.0.0.0 ~ 10.255.255.255
B类私有		172.16.0.0 ~ 172.31.255.255
C类私有		192.168.0.0 ~ 192.168.255.255
特殊IP：
127开头用来做测试用，如127.0.0.X，回环IP，看网卡是否正常
255.255.255.255 为广播地址
根据目的地址数量分类：
单播，  目的地址为1个，如悄悄话
组播，	目的地址为1群，如跟一组人聊天
广播，	目的地址为本网络中所有用户，如授课一个班
子网掩码
IP地址化成二进制形式和掩码二进制形式做与运算后可算出网段，测试目标地址与源地址是否在同一网段内
各类IP地址的子网掩码
A类 		 255.0.0.0
B类		255.255.0.0
C类		255.255.255.0
		网络位		主机位
A类		8位 		 24位
B类		16位         16位
C类		24位	  8位
特殊的IP地址
127开头用来做测试用，如127.0.0.X，回环IP，看网卡是否正常
在windows无法自动获取IP地址时（没有DHCP服务支持），windows会自动分配一个169.254.X.X的地址这个也属于回环地址

ping 目标IP地址 	这个命令是用来测试和目标地址的连通性
该命令使用的是ICMP协议（简单报文传输协议）

ARP   
地址解析协议，用来解析I P地址和MAC地址映射关系
知道一个IP，想知道对方MAC为多少
两台机器交互首先需要知道对方IP，知道IP后进行封装，而链路层要封装MAC地址，这时候发送ARP广播，广播目的地址是本网段的所有主机，所有主机收到开始匹配，匹配到的主机回应MAC地址，得到目的主机MAC地址后封装到帧首部就可直接进行数据通信。
图示工作原理
例子
Arp –a  查看arp映射关系表
ARP高速缓存
ARP高校运行的关键是由于每个主机上都有一个ARP高速缓存，存放最近Internet地址到硬件地址之间的映射记录。高速缓存中每一项的生存时间一般为20分钟。

ARP代理
ARP请求为一个网络主机发往另一个网络主机，广播是不经过路由器的，也就是说网关不转发广播，中间的路由器做应答，路由器的功能相当于目的主机的代理。
这种方式也可称为ARP欺骗

RARP   逆地址解析协议
与ARP相反，先知道MAC，通过MAC解析IP

路由器：路径的选择，通过路由表可以实现跨网段的通信
IP路由选择
路由表
先找目的IP
后找目的网段
最后找默认网关

###传输层
定义传输方式：可靠性传输，不可靠性传输
TCP：可靠性传输
UDP：不可靠性传输
特点
TCP：完整性，安全性但相对速度会变慢
UDP：速度快
TCP协议常用于数据上传，邮件，数据下载等
UDP协议常用于视频音频的传输
使用这两类协议协议的服务或软件有很多，需要来分别每个服务和软件就会需要用到端口的概念
端口号：物理端口号，逻辑端口号
物理端口号是指真实设备的接口号，比如交换机或路由器上的接口
逻辑端口号就是用来区分我们TCP和UDP众多服务或软件用的，必须要记住常用服务的端口号
端口号的范围从0到65535
常用的端口号
TCP 20号端口=FTP（文件传输） 数据传输
TCP 21号端口=FTP 控制链接
TCP 22号端口=SSH（安全服务）
TCP 25号端口=SMTP（电子邮件）
TCP 80号端口=HTTP（超文本传输协议）
UDP 69号端口=TFTP（简单文件传输）
UDP 53号端口=DNS（域名解析服务）等
知名端口号：1 ~ 1023 (1024以下不可用)
端口号5000以上可自定义使用

###会话层
只管理会话：建立连接和断开链接，信号会出现在TCP报头中
###表示层
对数据包进行，加密；解密；压缩；解压缩；数据重组
由于大的数据不能直接拿来传输所以要进行数据的分解，在表示层时会把分解的数据进行重新组合
###应用层
应用程序，软件，多为开发人员涉及



TCP/IP 四层

应用层（应用，表示，会话）

传输层

网络层

接口层（物理层和数据链路层）

